# Task discussion T050: Расширить hall_tree.json: Wing 2 для Акта 2 + резонансы между актами

## [2026-02-27 08:31] boss (author)

### Task description

Расширить Древо залов для поддержки уровней Акта 2.

ЗАДАЧИ:

1. **Добавить Wing 2 в hall_tree.json**:
   - wing_2: 'Второе крыло: Внутренние замки'
   - Залы: act2_level13 .. act2_level16 (первый блок Акта 2)
   - Gate: threshold (пройти 8 из 12 залов Wing 1 для доступа)
   - Начальный зал: act2_level13
   - Граф зависимостей внутри Wing 2 (нелинейный, 2-3 пути)
   - Placeholder для будущих уровней 17-24

2. **Добавить резонансы между Wing 1 и Wing 2**:
   - act1_level09 (S3) ↔ act2_level13 (S3 с подгруппами): 'та же группа, новый взгляд'
   - act1_level05 (D4) ↔ act2_level14 (D4 с подгруппами): 'те же симметрии, внутренняя структура'
   - Тип: 'same_group_deeper' — новый тип резонанса для связи между актами

3. **Обновить HallProgressionEngine**:
   - Поддержка нескольких Wings
   - Gate между Wing 1 и Wing 2
   - get_available_halls() включает залы из доступных Wings

4. **Обновить MapScene**:
   - Отображение Wing 2 на карте (ниже/правее Wing 1)
   - Визуальная связь gate между крыльями
   - Анимация разблокировки Wing 2 при достижении порога
   - Скролл карты для вмещения двух крыльев

5. **Тесты**:
   - test_hall_tree_data.py: парсинг 2 wings
   - test_hall_progression.py: переход между wings
   - test_wing2_gate: threshold gate работает

MUST прочитать:
- data/hall_tree.json (текущий файл)
- src/core/hall_tree_data.gd
- src/core/hall_progression_engine.gd
- src/ui/map_scene.gd
- .tayfa/architect/ARCH_T024_HALL_TREE.md (спецификация поддержки нескольких wings)

### Acceptance criteria

[To be clarified]

---
