# Task discussion T031: Реализовать HallProgressionEngine

## [2026-02-26 15:01] boss (author)

### Task description

Реализация MVP Древа залов — ЧАСТЬ 2: Движок прогрессии.

По архитектурному плану из .tayfa/architect/ARCH_T024_HALL_TREE.md:

1. Создать src/core/hall_progression_engine.gd — класс HallProgressionEngine:
   - Зависит от HallTreeData (T030)
   - get_hall_state(hall_id) -> enum {LOCKED, AVAILABLE, COMPLETED, PERFECT}
   - is_wing_accessible(wing_id) -> bool
   - get_available_halls() -> Array[String]
   - complete_hall(hall_id) -> void (обновляет состояния, проверяет ворота крыла)
   - 3 типа ворот: threshold (N из M), all (100%), specific (конкретные залы)
   - Интеграция с GameManager.completed_levels

2. Написать тесты test_hall_progression.gd:
   - Тест threshold gate (7 из 12)
   - Тест разблокировки зависимых залов
   - Тест состояний LOCKED->AVAILABLE->COMPLETED

MUST прочитать: .tayfa/architect/ARCH_T024_HALL_TREE.md

### Acceptance criteria

[To be clarified]

---
