# Mathematical Structures for Act 1, Levels 1-3

## Overview
Levels 1-3 introduce the player to the cyclic group Z₃ through triangle rotations. Each level presents an equilateral triangle of crystals where the player discovers rotational symmetries.

---

## Level 1: Basic Triangle Rotation

### Graph Structure

**Nodes:**
```
Node 0: position (0.0, -0.577), color: RED
Node 1: position (-0.5, 0.289), color: RED
Node 2: position (0.5, 0.289), color: RED
```

**Edges:**
```
Edge (0, 1): type: STANDARD
Edge (1, 2): type: STANDARD
Edge (2, 0): type: STANDARD
```

**Visual Layout:**
```
      1
     / \
    /   \
   2-----0
```

### Valid Permutations (Automorphisms)

**Identity (e):**
```
0 → 0
1 → 1
2 → 2
```
Permutation notation: `()`
Description: No rotation, leaves all nodes in place.

**Rotation 120° clockwise (r):**
```
0 → 1
1 → 2
2 → 0
```
Permutation notation: `(0 1 2)`
Description: Rotates triangle 120° clockwise around center.

**Rotation 240° clockwise (r²):**
```
0 → 2
1 → 0
2 → 1
```
Permutation notation: `(0 2 1)`
Description: Rotates triangle 240° clockwise (or 120° counter-clockwise) around center.

### Group Structure

**Group:** Cyclic group Z₃ (also written as C₃)
**Order:** 3
**Generators:** {r}
**Relations:** r³ = e

### Cayley Table

```
 ∘  | e  | r  | r² |
----|----|----|----|
 e  | e  | r  | r² |
 r  | r  | r² | e  |
 r² | r² | e  | r  |
```

**Composition Examples:**
- r ∘ r = r² (rotate 120° then 120° = 240° rotation)
- r ∘ r² = e (rotate 120° then 240° = 360° = identity)
- r² ∘ r = e (rotate 240° then 120° = 360° = identity)

### Properties
- **Abelian:** Yes (all cyclic groups are abelian)
- **Inverse elements:** e⁻¹ = e, r⁻¹ = r², (r²)⁻¹ = r
- **Subgroups:** {e} (trivial), {e, r, r²} (whole group)

---

## Level 2: Triangle with Distinct Edge

### Graph Structure

**Nodes:**
```
Node 0: position (0.0, -0.577), color: BLUE
Node 1: position (-0.5, 0.289), color: BLUE
Node 2: position (0.5, 0.289), color: BLUE
```

**Edges:**
```
Edge (0, 1): type: STANDARD
Edge (1, 2): type: THICK
Edge (2, 0): type: STANDARD
```

**Visual Layout:**
```
      1
     / ═  ← THICK edge
    /   ═
   2-----0
```

### Valid Permutations (Automorphisms)

**Identity (e):**
```
0 → 0
1 → 1
2 → 2
```
Permutation notation: `()`
Description: No rotation.

**Rotation 120° clockwise (r):**
```
0 → 1
1 → 2
2 → 0
```
Permutation notation: `(0 1 2)`
Description: THICK edge (1,2) moves to position (2,0).

**Rotation 240° clockwise (r²):**
```
0 → 2
1 → 0
2 → 1
```
Permutation notation: `(0 2 1)`
Description: THICK edge (1,2) moves to position (0,1).

### Group Structure

**Group:** Cyclic group Z₃
**Order:** 3
**Generators:** {r}
**Relations:** r³ = e

### Cayley Table

```
 ∘  | e  | r  | r² |
----|----|----|----|
 e  | e  | r  | r² |
 r  | r  | r² | e  |
 r² | r² | e  | r  |
```

### Properties
- **Abelian:** Yes
- **Inverse elements:** e⁻¹ = e, r⁻¹ = r², (r²)⁻¹ = r
- **Subgroups:** {e}, {e, r, r²}

### Pedagogical Note
This level teaches that symmetry is not about "looking the same" but about preserving structure. The THICK edge breaks visual symmetry but the graph still has rotational automorphisms because the edge structure is preserved under rotation.

---

## Level 3: Triangle with Colored Nodes

### Graph Structure

**Nodes:**
```
Node 0: position (0.0, -0.577), color: RED
Node 1: position (-0.5, 0.289), color: GREEN
Node 2: position (0.5, 0.289), color: GREEN
```

**Edges:**
```
Edge (0, 1): type: STANDARD
Edge (1, 2): type: STANDARD
Edge (2, 0): type: STANDARD
```

**Visual Layout:**
```
    G 1
     / \
    /   \
 G 2-----0 R
```

### Valid Permutations (Automorphisms)

**Identity (e):**
```
0 → 0
1 → 1
2 → 2
```
Permutation notation: `()`
Description: No transformation.

**Swap green nodes (s):**
```
0 → 0
1 → 2
2 → 1
```
Permutation notation: `(1 2)`
Description: Reflection that swaps the two GREEN nodes, keeping RED node fixed.

### Group Structure

**Group:** Cyclic group Z₂ (also written as C₂)
**Order:** 2
**Generators:** {s}
**Relations:** s² = e

### Cayley Table

```
 ∘  | e  | s  |
----|----|----|
 e  | e  | s  |
 s  | s  | e  |
```

**Composition Examples:**
- s ∘ s = e (swapping twice returns to original)

### Properties
- **Abelian:** Yes (all groups of order 2 are abelian)
- **Inverse elements:** e⁻¹ = e, s⁻¹ = s (s is self-inverse)
- **Subgroups:** {e}, {e, s}
- **Isomorphic to:** Z₂, the integers modulo 2 under addition

### Pedagogical Note
This level introduces a different symmetry group (Z₂ instead of Z₃) to show variety. The color constraint reduces the symmetry - only permutations preserving node colors are valid. This demonstrates how constraints affect the automorphism group.

---

## Implementation Notes for Developers

### Data Structure Recommendations

**Node Structure:**
```json
{
  "id": 0,
  "position": {"x": 0.0, "y": -0.577},
  "color": "RED"
}
```

**Edge Structure:**
```json
{
  "from": 0,
  "to": 1,
  "type": "STANDARD"
}
```

**Permutation Structure:**
```json
{
  "id": "r",
  "name": "Rotation 120°",
  "mapping": [1, 2, 0],
  "discovered": false
}
```

### Validation Algorithm

To check if a permutation P is a valid automorphism:

1. For each edge (u, v) with type T in the original graph:
   - Check that edge (P(u), P(v)) exists with the same type T
2. For each node n with color C:
   - Check that node P(n) has the same color C
3. If all checks pass, P is a valid automorphism

### Cayley Table Construction

When player combines two permutations:
1. Apply first permutation P₁
2. Apply second permutation P₂ to the result
3. The composition P₂ ∘ P₁ maps: i → P₂(P₁(i))
4. Store in Cayley table at position [P₂][P₁]

### Group Detection

After finding all automorphisms:
1. Count total automorphisms = group order
2. Check if all compositions of found automorphisms are also found
3. Verify identity exists
4. Verify each element has an inverse
5. Level complete when all automorphisms discovered

---

## Mathematical Summary

| Level | Graph Type | Group | Order | Generators | Key Concept |
|-------|-----------|-------|-------|------------|-------------|
| 1 | Uniform triangle | Z₃ | 3 | {r} | Basic rotation |
| 2 | Triangle with marked edge | Z₃ | 3 | {r} | Structure over appearance |
| 3 | Triangle with colored nodes | Z₂ | 2 | {s} | Constraints reduce symmetry |

### Learning Progression

1. **Level 1:** Discover that rotations preserve structure
2. **Level 2:** Learn that visual asymmetry can still have symmetry
3. **Level 3:** Understand that constraints (colors) reduce the symmetry group

By the end of Level 3, players intuitively understand:
- Identity transformation
- Composition of transformations
- Inverse transformations
- Closure property of groups
- How structure determines symmetry

---

## Testing Checklist

- [ ] Level 1: All 3 rotations are discoverable
- [ ] Level 1: Composing r with r gives r²
- [ ] Level 1: Composing r three times gives identity
- [ ] Level 2: THICK edge prevents reflections but allows rotations
- [ ] Level 2: Same Cayley table as Level 1
- [ ] Level 3: Only identity and one swap are valid
- [ ] Level 3: RED node never moves
- [ ] Level 3: Swapping twice returns to identity
- [ ] All levels: Invalid permutations are rejected with visual feedback
- [ ] All levels: Cayley table can be constructed by player combinations
