# Task discussion T032: Реализовать MapScene — экран карты мира

## [2026-02-26 15:01] boss (author)

### Task description

Реализация MVP Древа залов — ЧАСТЬ 3: UI карты.

По архитектурному плану из .tayfa/architect/ARCH_T024_HALL_TREE.md:

1. Создать src/ui/map_scene.gd + map_scene.tscn — главный экран карты:
   - Отображает граф залов из HallTreeData
   - BFS-layout для позиционирования узлов
   - Клик на зал -> переход в LevelScene (через GameManager)
   - Подсветка доступных залов, затемнение закрытых
   - Показ прогресса крыла (X / total_halls)

2. Создать src/ui/hall_node_visual.gd + hall_node_visual.tscn:
   - 4 визуальных состояния: LOCKED (серый, замок), AVAILABLE (яркий, пульсирует), COMPLETED (зелёная галочка), PERFECT (золотой блеск)
   - Название зала и иконка группы
   - Hover/click взаимодействие

3. Создать src/ui/map_layout_engine.gd:
   - BFS-раскладка дерева от start_halls
   - Автоматическое расположение узлов без пересечений
   - Рисование связей между залами (Line2D)

4. Модифицировать GameManager: добавить загрузку hall_tree, переход на карту после завершения уровня
5. Модифицировать LevelScene: заменить 'NEXT LEVEL' на 'ВЕРНУТЬСЯ НА КАРТУ'

MUST прочитать: .tayfa/architect/ARCH_T024_HALL_TREE.md

### Acceptance criteria

[To be clarified]

---
