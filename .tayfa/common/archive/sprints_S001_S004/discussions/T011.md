# Task discussion T011: CRITICAL: Fix swap mechanics - swaps must accumulate

## [2026-02-21 00:59] boss (author)

### Task description

Current bug: after an invalid swap, the game resets ALL crystals to their starting positions (_reset_arrangement). This makes it IMPOSSIBLE to achieve rotations like [1,2,0] because a rotation requires TWO transpositions, but the first transposition [1,0,2] is invalid and triggers a reset. FIX: Remove auto-reset on invalid permutation. Swaps should accumulate. After each swap, check the CUMULATIVE permutation against target automorphisms. If valid - celebrate and record. If invalid - do NOT reset, let the player keep experimenting. Add a manual RESET button instead. Also add a CHECK CURRENT button that validates without requiring a swap. This is the #1 blocker - the game is literally unplayable without this fix. MUST READ Game.txt and test by actually running the game with run_game.bat.

### Acceptance criteria

[To be clarified]

---
