# «Хранители Симметрий» — ревизия дизайна

## Преамбула: в чём проблема исходного проекта

Исходный проект делает одну вещь отлично — переводит алгебраические объекты в тактильный опыт. Но у него три системных слабости:

1. **Разрыв абстракции в Акте 3.** Переход от «перетаскивания кристаллов» к «палитре с правилами смешивания» — это скачок уровня абстракции, который не подготовлен предыдущим опытом. Игрок, привыкший трогать вещи руками, внезапно должен думать о правилах между правилами.

2. **Пассивность обучения.** Игрок решает головоломки, но игра никогда не заставляет его *формулировать* то, что он понял. А без формулирования — хотя бы на уровне «я заметил, что...» — понимание рассеивается через час после выхода из игры.

3. **Линейность.** 45 уровней подряд — это конвейер, а не исследование. У игрока нет ощущения, что он сам выбирает, куда копать. Теория Галуа как раз про то, что сложные объекты можно разбирать разными путями — и игра должна это отражать.

Ниже — конкретные изменения, организованные по системам.

---

## 1. Структура мира: от линейки уровней к «Древу Залов»

### Проблема
Линейная последовательность уровней убивает ощущение исследования. Игрок не принимает стратегических решений — просто идёт вперёд.

### Решение
Заменить линейную прогрессию на **граф залов** — древовидную карту, где из каждого узла есть 2–3 пути. Залы объединены в «крылья» храма (аналог актов), но внутри крыла игрок волен выбирать порядок.

Ключевое правило: чтобы открыть зал следующего крыла, нужно пройти **не все**, а **достаточно много** залов текущего (например, 7 из 10). Это позволяет:
- пропустить зал, если застрял, и вернуться позже;
- дать «боковые» залы с углублённым исследованием для тех, кому интересно;
- создать залы-развилки, где выбор пути влияет на то, какие инструменты игрок освоит раньше.

### Дополнительная механика: «Резонанс»
Если игрок прошёл два зала, которые связаны скрытой математической связью (например, их группы — подгруппа и факторгруппа одной большой группы), между ними на карте загорается «резонансная нить». Это чисто визуальная награда, но она подталкивает к мысли: «Почему эти два зала связаны?» Самые любопытные игроки начнут проходить дополнительные залы, чтобы увидеть всю паутину резонансов.

---

## 2. Система «Заметок» вместо пассивного дневника

### Проблема
В исходном проекте был «дневник исследователя» — текст, который игра показывает после блока уровней. Но это пассивное чтение. Игрок может его пропустить, не усвоив ничего.

### Решение: активные заметки
После каждых 3–4 залов игра открывает **«стол исследователя»** — экран, где игрок должен сам что-то сделать:

**Тип 1: Предсказание.** Игра показывает новый, ещё не пройденный зал (его граф), и спрашивает: «Сколько ключей здесь будет?» или «Есть ли здесь внутренняя дверь?». Игрок делает ставку. Потом проходит зал и видит, угадал ли. Неверное предсказание — не штраф, а повод задуматься.

**Тип 2: Классификация.** Игра показывает несколько уже пройденных залов и спрашивает: «Какие из них устроены одинаково?» (Изоморфны.) Игрок перетаскивает карточки залов в группы. Так он учится видеть, что визуально разные графы могут иметь одну и ту же группу симметрий.

**Тип 3: Формулировка.** Игра даёт незаконченное утверждение с пропусками и набор слов-плиток, из которых нужно собрать фразу. Например:

> «Если все ключи можно получить комбинациями из [___], то этот набор называется [___] зала.»
>
> Плитки: *одного ключа / двух ключей / генераторами / стенами / симметриями*

Это не экзамен. Неправильный ответ показывает мягкую подсказку и позволяет попробовать снова. Но сам акт *выбора слов* заставляет мозг структурировать интуицию.

**Тип 4: Конструирование.** «Нарисуй граф, у которого ровно 4 ключа.» Или: «Нарисуй граф, у которого есть нормальная подгруппа порядка 2.» Игрок работает в редакторе — ставит узлы, рисует связи, — а игра проверяет, верна ли его конструкция. Это самый мощный тип задания: создание примеров развивает понимание в разы быстрее, чем решение готовых.

### Тон заметок
Всё оформлено как «полевой дневник» вымышленного исследователя, который изучал храм до игрока и оставил обрывки записей. Игрок как бы продолжает его работу. Это даёт нарративную рамку без занудства.

---

## 3. Переработка Акта 3: «Палитра» через действие, а не абстракцию

### Проблема
Исходная «палитра с правилами смешивания» — это замаскированная таблица умножения поля. Для игрока, который до этого двигал кристаллы, это слишком абстрактный скачок. Разрыв сравним с тем, как если бы в Portal на 30-м уровне внезапно появились дифференциальные уравнения.

### Решение: вместо палитры — «Ткацкий станок»

Новая метафора для расширений полей — **ткачество**. Вот как это работает:

У игрока есть набор **нитей** — каждая нить имеет цвет. Нити можно **переплетать** (это операция поля). Переплетение двух нитей даёт новую нить предсказуемого цвета — правила переплетения фиксированы и видимы.

Некоторые залы содержат кристаллы, окрашенные в цвет, которого нет среди нитей игрока. Чтобы войти, нужно **добавить нить нового цвета** и определить, как она переплетается со всеми существующими.

Почему это лучше абстрактной палитры:

- **Физичность.** Игрок буквально протягивает нити через станок и видит, какой цвет получается. Это тактильная операция, а не заполнение таблицы.
- **Ограничения видны.** Если новая нить несовместима с правилами (нарушает ассоциативность или порождает противоречие), ткань «расползается» — визуально и звуково. Игрок чувствует, что не любое расширение допустимо.
- **Автоморфизмы расширения = перекраска нитей.** Если можно перекрасить новую нить в другой цвет, и вся ткань останется непротиворечивой — это автоморфизм. Игрок пробует перекраски так же, как раньше пробовал перестановки кристаллов. Одинаковый жест — перетаскивание — в разном контексте.

### Сшивка с Актами 1–2
Критический момент: когда игрок добавляет нить и обнаруживает допустимые перекраски, ткацкий станок **трансформируется в зал с кристаллами**, где перекраски — это ключи. Игрок видит это превращение анимированно. Так связь между расширениями и группами не объясняется — она *происходит на экране*.

---

## 4. Механика «Двойного зрения» вместо двух экранов

### Проблема
Два одновременных экрана (палитра и группа) — информационная перегрузка. Игрок не знает, куда смотреть.

### Решение
Один экран с переключением «режимов зрения» — горячая клавиша или жест. В режиме A игрок видит ткацкий станок (расширение). В режиме B — зал с кристаллами (группа). Переключение мгновенное, с плавной морф-анимацией, где нити перестраиваются в кристаллы и обратно.

Суть: каждому элементу ткацкого станка однозначно соответствует элемент зала. Промежуточная нить ↔ подгруппа ключей. Игрок может решить головоломку в любом режиме, но некоторые вещи проще увидеть в одном, а другие — в другом. Игра мотивирует переключаться.

Конкретный пример: нужно найти промежуточное расширение. В режиме A (ткань) — это «какие нити можно убрать, чтобы ткань не развалилась?». В режиме B (зал) — это «какие ключи образуют нормальную подгруппу?». Два способа увидеть одно и то же. Игрок начинает переключаться рефлекторно — и в этот момент соответствие Галуа прошивается в моторную память.

---

## 5. «Невозможные залы» — обучение через провал

### Проблема
В оригинальном проекте игрок всегда побеждает. Но центральная теорема теории Галуа — теорема о *невозможности*. Если игрок не переживёт невозможность как опыт, он не поймёт самого главного.

### Решение: залы-ловушки
Начиная с Акта 2, среди обычных залов попадаются **невозможные залы** — задания, которые *нельзя* выполнить. Примеры:

- «Найди нормальную подгруппу» в зале, у которого группа простая (и нетривиальных нормальных подгрупп нет).
- «Разложи этот замок на простые слои» для A₅.
- «Добавь промежуточную нить» для расширения, не имеющего промежуточных подрасширений.

Игрок не знает заранее, что зал невозможный. Он пробует, пробует, и в какой-то момент может нажать кнопку **«Я утверждаю, что это невозможно»**. Если он прав — зал засчитывается как пройденный, причём с особой наградой («Печать невозможности»). Если неправ — игра мягко показывает контрпример.

Это критически важная механика. Она учит тому, чему математика учит в первую очередь: **«невозможно» — это тоже ответ, и он может быть строго обоснован**.

Чтобы кнопка не превратилась в способ пропускать сложные уровни, можно добавить требование: перед утверждением невозможности нужно «предъявить свидетельство» — например, показать, что все подгруппы были проверены и ни одна не нормальна. Конкретная форма зависит от типа невозможности.

---

## 6. Мультиплеер: «Зал на двоих»

### Зачем
Теория Галуа — это про соответствие между двумя точками зрения. Два игрока — естественная метафора.

### Механика
Кооперативный режим на двоих (локальный или онлайн). Один игрок видит ткацкий станок (расширение). Второй — зал с кристаллами (группу). Они должны *общаться словами*, чтобы вместе решить головоломку, потому что каждый видит только половину картины.

Пример: игроку A нужно найти промежуточное расширение, но он не знает, какие подгруппы нормальны. Игрок B видит подгруппы, но не знает, как они связаны с нитями. Они должны выработать общий язык — «у меня есть подгруппа из трёх ключей, один из которых — отражение» → «попробую убрать синюю нить, потому что у неё три варианта перекраски».

Это гениально с педагогической точки зрения: необходимость *объяснить другому* то, что ты видишь, — самый сильный из известных механизмов обучения.

---

## 7. Sandbox-режим: «Мастерская»

### Зачем
Самое глубокое понимание приходит не от решения чужих задач, а от создания своих.

### Механика
После прохождения каждого крыла открывается мастерская, где игрок может:

- **Построить свой зал**: расставить кристаллы, провести связи, и увидеть, какую группу симметрий он случайно создал. Игра автоматически считает группу и показывает её свойства.
- **Построить свой ткацкий станок**: задать правила переплетения и увидеть, какая структура возникнет.
- **Задать задачу другу**: сконструировать зал и отправить другому игроку как челлендж.

Для продвинутых игроков — режим «Каталог», где игра предлагает: «Построй зал с группой, изоморфной S₃», и игрок конструирует граф, проверяя гипотезы.

---

## 8. Переработка финала (Акт 4)

### Проблема
В оригинальном проекте босс A₅ — просто очень сложный зал. Но драматургически не хватает *осмысления*.

### Решение: три фазы финала

**Фаза 1 — Ложная надежда.** Игрок получает зал с группой S₅ (120 симметрий). Он пробует стратегию факторизации — и она работает! S₅ содержит нормальную подгруппу A₅. Игрок успешно делает одну факторизацию: S₅ → A₅ → ???. Он ожидает, что A₅ тоже разложится.

**Фаза 2 — Стена.** Внутри A₅ — ничего. Никакие нормальные подгруппы не находятся. Игрок использует все инструменты: проверяет каждую подгруппу (их несколько — Z₂, Z₃, Z₅, V₄, D₅, A₄...), ни одна не нормальна кроме тривиальных. Кнопка «невозможно» активна, но нажать её — значит признать поражение.

**Фаза 3 — Принятие.** Когда игрок нажимает «невозможно» (и предъявляет свидетельство — полный список подгрупп), зал не открывается обычной анимацией. Вместо этого — тишина, и медленно проявляется **обратная перспектива**: камера показывает все пять крыльев храма сверху. Первые четыре — залы, которые поддавались факторизации. Пятое — нет. Голос исследователя из дневника:

> «Я потратил три года, пытаясь вскрыть этот зал послойно. Сегодня я понял, что провёл три года не впустую. Я доказал, что это невозможно. И это — более глубокое знание, чем если бы он просто открылся.»

Зал засчитывается. Титры.

---

## 9. Система подсказок: «Эхо»

### Проблема
Головоломки без подсказок отсеивают большинство игроков. Головоломки с подсказками убивают удовольствие от открытия.

### Решение: трёхуровневая система
Если игрок застрял (не делал прогресса 5+ минут), в углу экрана начинает мерцать значок «Эхо» — фрагмент записей предыдущего исследователя.

**Уровень 1 — Направление.** Расплывчатый намёк. Пример: «Исследователь пометил на полях: *Попробуй начать с крайнего узла — он единственный, который связан со всеми.*»

**Уровень 2 — Структура.** Более конкретная подсказка. Пример: «В записях нарисована стрелка от кристалла A к кристаллу C с пометкой: *эти двое всегда ходят парой.*»

**Уровень 3 — Решение.** Пошаговое объяснение одного возможного пути. Доступно только после двух предыдущих уровней. Снимает «Печать совершенства» с зала, но не «Печать прохождения».

Каждый уровень подсказки требует отдельного нажатия с задержкой в 2 минуты. Это не даёт импульсивно проскроллить до ответа, но и не мучает тех, кому реально нужна помощь.

---

## 10. «Глоссарий живых понятий»

### Зачем
Игрок проходит игру и получает интуицию — но не знает слов. Если через полгода он откроет учебник алгебры, он не узнает знакомые концепции. Нужен мост.

### Решение
В меню доступен **Глоссарий**, который заполняется по мере прохождения. Каждая запись состоит из трёх слоёв:

**Слой 1 — Игровой термин.** «Кольцо ключей зала» — это набор всех допустимых перестановок.

**Слой 2 — Наблюдение.** «Кольцо ключей всегда содержит «пустой» ключ (ничего не двигать) и для каждого ключа — обратный ключ, который отменяет его действие. Комбинация двух ключей всегда тоже ключ.»

**Слой 3 — Математическое имя (скрыт по умолчанию).** «В математике это называется *группой автоморфизмов графа*. Более общее понятие — *группа*. Замкнутость, наличие единицы, наличие обратного — это аксиомы группы.»

Третий слой открывается по нажатию, и игрок видит: «О, так то, что я делал — это группа!» Этот момент узнавания — одно из самых мощных обучающих переживаний.

В конце игры глоссарий содержит около 25 записей, покрывающих: группу, подгруппу, нормальную подгруппу, факторгруппу, простую группу, разрешимую группу, порядок элемента, генераторы, изоморфизм, автоморфизм, расширение поля, промежуточное расширение, группу Галуа, соответствие Галуа, разрешимость уравнений.

---

## 11. Звуковой дизайн как обучающий инструмент

### Идея
Каждая группа имеет свой **звуковой портрет**. Не музыку-фон — а звук, порождённый структурой группы.

Как это работает: каждому элементу группы присвоен тон. Композиция двух элементов — аккорд из трёх нот (два исходных + результат). Коммутативные группы звучат гармонично (порядок не важен — аккорды симметричны). Некоммутативные — диссонансно. Циклические группы звучат как восходящие гаммы. S₃ — как джаз. A₅ — как нечто сложное, атональное, несводимое к простым интервалам.

Игрок, пройдя десяток залов, начинает *на слух* различать типы групп. Это не обязательно для прохождения — но те, кто обратит внимание, получат ещё один канал интуиции.

Особый момент: когда игрок пытается разложить A₅ и терпит неудачу, звуковой портрет этой группы не распадается на простые мелодии. Он остаётся цельным, неразложимым звуком. Это эстетическое переживание невозможности.

---

## 12. Послеигровой «мост» — от игры к математике

### Зачем
Если игра заканчивается титрами — связь с реальной математикой остаётся хрупкой. Нужен мягкий выход в реальный мир.

### Решение
После титров открывается **«Библиотека храма»** — раздел с тремя уровнями глубины:

**«Открытки»** — 10 коротких текстов (по абзацу), связывающих игровой опыт с историей математики. Пример: «Зал A₅, который ты не смог разложить — это та самая причина, по которой Эварист Галуа в 1832 году доказал, что не существует общей формулы для решения уравнений пятой степени. Ему было двадцать лет.»

**«Карта знаний»** — визуальная схема, показывающая, какие разделы математики соответствуют каким крыльям храма. Со ссылками на конкретные главы конкретных учебников (например: «Крыло 2 → Hungerford, *Abstract Algebra*, Chapter 2.5» или «Visual Group Theory, Nathan Carter — вся книга»).

**«Нерешённые залы»** — краткие описания открытых проблем теории групп и теории Галуа, сформулированных в терминах игры. Например: «Существуют ли залы, в которых количество ключей не встречается ни в одном из известных нам шаблонов?» (Обратная задача Галуа.) Это не для того, чтобы игрок их решил — а чтобы он почувствовал, что храм продолжается за пределы игры.

---

## Сводка изменений

| # | Изменение | Что решает | Приоритет |
|---|-----------|-----------|-----------|
| 1 | Древо залов вместо линейки | Ощущение исследования, свобода | Высокий |
| 2 | Активные заметки | Пассивность обучения | Высокий |
| 3 | Ткацкий станок вместо палитры | Разрыв абстракции в Акте 3 | Критический |
| 4 | Двойное зрение вместо двух экранов | Перегрузка информацией | Критический |
| 5 | Невозможные залы | Обучение невозможности | Высокий |
| 6 | Кооперативный мультиплеер | Глубина понимания через объяснение | Средний |
| 7 | Sandbox-мастерская | Обучение через конструирование | Средний |
| 8 | Трёхфазный финал | Драматургия и осмысление | Высокий |
| 9 | Система подсказок «Эхо» | Удержание аудитории | Высокий |
| 10 | Живой глоссарий | Мост к формальной математике | Высокий |
| 11 | Звуковой дизайн групп | Дополнительный канал интуиции | Средний |
| 12 | Библиотека храма | Послеигровой мост | Средний |

---

## Финальное замечание

Самое важное изменение — не конкретная механика, а **принцип**: игрок должен не только *решать*, но и *формулировать*, *предсказывать*, *конструировать* и *признавать невозможность*. Это четыре режима математического мышления, и игра, которая задействует все четыре, учит не теории Галуа как набору фактов — а тому, как думает математик.
