# «Хранители Симметрий» — ревизия дизайна

## Преамбула: в чём проблема исходного проекта

Исходный проект делает одну вещь отлично — переводит алгебраические объекты в тактильный опыт. Но у него три системных слабости:

1. **Разрыв абстракции в Акте 3.** Переход от «перетаскивания кристаллов» к «палитре с правилами смешивания» — это скачок уровня абстракции, который не подготовлен предыдущим опытом. Игрок, привыкший трогать вещи руками, внезапно должен думать о правилах между правилами.

2. **Пассивность обучения.** Игрок решает головоломки, но игра никогда не заставляет его *формулировать* то, что он понял. А без формулирования — хотя бы на уровне «я заметил, что...» — понимание рассеивается через час после выхода из игры.

3. **Линейность.** 45 уровней подряд — это конвейер, а не исследование. У игрока нет ощущения, что он сам выбирает, куда копать. Теория Галуа как раз про то, что сложные объекты можно разбирать разными путями — и игра должна это отражать.

Ниже — конкретные изменения, организованные по системам.

---

## 0. Архитектура слоёв: единая карта, пять цветов

### Концепция
Вместо отдельных актов игра использует **единую карту** с **пятью слоями**, каждый из которых имеет свой цвет и тип заданий. Игрок проходит одни и те же локации многократно, но каждый раз — с новыми задачами, соответствующими текущему слою.

### Пять слоёв прогрессии

**Слой 1 (Цвет: синий)** — Ключи и комнаты
- Задание: найти автоморфизмы (ключи) и неподвижные элементы (комнаты)
- Игрок учится базовым операциям: перестановка кристаллов, поиск симметрий
- Интуиция: «Ключ — это способ переставить вещи, не меняя структуру»

**Слой 2 (Цвет: зелёный)** — Обратные ключи
- Задание: для каждого найденного ключа найти обратный ключ
- Игрок понимает обратимость операций
- Интуиция: «Любое действие можно отменить»

**Слой 3 (Цвет: золотой)** — Группы
- Задание: проверить, что набор ключей образует группу (замкнутость, ассоциативность)
- Игрок комбинирует ключи и видит композицию автоморфизмов
- Интуиция: «Ключи можно складывать, и результат — тоже ключ»

**Слой 4 (Цвет: красный)** — Нормальные группы
- Задание: проверить, является ли подгруппа (брелок) нормальной
- Механика: **«Взлом брелков»** (подробно описана в секции 3.5)
- Интуиция: «Некоторые наборы ключей особенные — их нельзя "взломать"»

**Слой 5 (Цвет: фиолетовый)** — Факторгруппы
- Задание: построить факторгруппу G/H для нормальной подгруппы H
- Игрок работает с классами смежности как с новыми элементами
- Интуиция: «Можно склеить части залов вместе и получить новый, меньший зал»

### Правила прогрессии
- **Линейная разблокировка**: нельзя перейти к слою N+1, пока не пройдено достаточное количество уровней слоя N
- **Критерий разблокировки**: определяется динамически (например, 70% уровней текущего слоя)
- **Цветовая индикация**: карта меняет цветовую палитру при переходе между слоями
- **Возврат к пройденным слоям**: возможен (для повторения материала)
- **Одна локация — разные задания**: в локации "Башня" на слое 1 ищем ключи, на слое 2 — обратные ключи, на слое 3 — проверяем групповую структуру, на слое 4 — взламываем брелки, на слое 5 — строим факторгруппы

### Преимущества архитектуры
1. **Узнаваемость**: игрок возвращается в знакомые места с новым пониманием
2. **Педагогическая спираль**: повторение + усложнение = глубокое усвоение
3. **Визуальная ясность**: цвет сразу показывает уровень сложности
4. **Экономия разработки**: одна карта вместо пяти актов

---

## 1. Структура мира: единая карта с цветовыми слоями

### Проблема
Линейная последовательность уровней убивает ощущение исследования. Игрок не принимает стратегических решений — просто идёт вперёд.

### Решение
**Единая карта** с **древовидной структурой локаций**, которую игрок проходит **пять раз** — по одному разу на каждый цветовой слой.

**Ключевые принципы:**
- **Одна география**: игрок видит одни и те же локации (Башня, Сад, Подземелье, Храм, etc.)
- **Пять проходов**: каждый слой меняет цвет карты и тип заданий
- **Нелинейность внутри слоя**: из каждой локации есть 2–3 пути к следующим
- **Прогрессия между слоями**: чтобы перейти к слою N+1, нужно пройти **достаточно много** (например, 70%) локаций слоя N

**Преимущества:**
- Игрок может пропустить сложную локацию и вернуться позже
- Возникает ощущение исследования: «Я выбираю, куда идти дальше»
- Повторное посещение знакомых мест с новыми задачами создаёт «спиральное обучение»

### Дополнительная механика: «Резонанс»
Если игрок прошёл две локации, которые связаны скрытой математической связью (например, одна содержит подгруппу, другая — факторгруппу той же большой группы), между ними на карте загорается **«резонансная нить»**.

Это чисто визуальная награда, но она подталкивает к вопросу: «Почему эти два места связаны?»

Самые любопытные игроки начнут проходить дополнительные локации, чтобы увидеть всю **паутину резонансов** — визуальное представление связей между математическими объектами.

---

## 2. Система «Заметок» вместо пассивного дневника

### Проблема
В исходном проекте был «дневник исследователя» — текст, который игра показывает после блока уровней. Но это пассивное чтение. Игрок может его пропустить, не усвоив ничего.

### Решение: активные заметки
После каждых 3–4 залов игра открывает **«стол исследователя»** — экран, где игрок должен сам что-то сделать:

**Тип 1: Предсказание.** Игра показывает новый, ещё не пройденный зал (его граф), и спрашивает: «Сколько ключей здесь будет?» или «Есть ли здесь внутренняя дверь?». Игрок делает ставку. Потом проходит зал и видит, угадал ли. Неверное предсказание — не штраф, а повод задуматься.

**Тип 2: Классификация.** Игра показывает несколько уже пройденных залов и спрашивает: «Какие из них устроены одинаково?» (Изоморфны.) Игрок перетаскивает карточки залов в группы. Так он учится видеть, что визуально разные графы могут иметь одну и ту же группу симметрий.

**Тип 3: Формулировка.** Игра даёт незаконченное утверждение с пропусками и набор слов-плиток, из которых нужно собрать фразу. Например:

> «Если все ключи можно получить комбинациями из [___], то этот набор называется [___] зала.»
>
> Плитки: *одного ключа / двух ключей / генераторами / стенами / симметриями*

Это не экзамен. Неправильный ответ показывает мягкую подсказку и позволяет попробовать снова. Но сам акт *выбора слов* заставляет мозг структурировать интуицию.

**Тип 4: Конструирование.** «Нарисуй граф, у которого ровно 4 ключа.» Или: «Нарисуй граф, у которого есть нормальная подгруппа порядка 2.» Игрок работает в редакторе — ставит узлы, рисует связи, — а игра проверяет, верна ли его конструкция. Это самый мощный тип задания: создание примеров развивает понимание в разы быстрее, чем решение готовых.

### Тон заметок
Всё оформлено как «полевой дневник» вымышленного исследователя, который изучал храм до игрока и оставил обрывки записей. Игрок как бы продолжает его работу. Это даёт нарративную рамку без занудства.

---

## 3. Слой 3: Группы — композиция и замкнутость

### Задача слоя
Игрок уже умеет находить ключи (слой 1) и обратные ключи (слой 2). Теперь он учится **комбинировать** ключи и понимать, что результат комбинации — тоже ключ.

### Механика
Для каждой локации игрок:
1. Видит набор ключей, найденных на слое 1
2. Может перетаскивать два ключа в «зону композиции»
3. Игра показывает анимацию последовательного применения двух ключей
4. Результат — новый ключ, который либо уже есть в наборе (группа замкнута), либо нет (нужно добавить)

**Критерий успеха**: игрок должен проверить, что:
- Любая комбинация двух ключей даёт ключ из набора (замкнутость)
- Есть «пустой» ключ — ничего не делать (единица)
- Для каждого ключа есть обратный (уже найдено на слое 2)

Когда все условия выполнены, набор ключей подсвечивается золотым — это **группа**.

### Визуальная награда
При успешной проверке группы на карте вокруг локации появляется золотое сияние. Если игрок прошёл несколько локаций на этом слое, золотые сияния начинают резонировать друг с другом, формируя паутину связей.

---

## 3.5. Слой 4: Нормальные группы — механика «Взлом брелков»

### Что игрок уже знает
К четвёртому слою игрок освоил:
- **Ключи** — автоморфизмы графа
- **Обратные ключи** — инверсные операции
- **Группы** — замкнутые наборы ключей
- **Подгруппы (брелки)** — меньшие наборы ключей внутри большой группы

Каждый брелок контролирует **«крыло»** — набор комнат, между которыми можно перемещаться только ключами этого брелка. Если стоишь в комнате и используешь только ключи брелка — ты ходишь по крылу и никогда не выходишь за его пределы.

### Новая задача: проверка на прочность
Игра говорит:
> «Не все крылья одинаково прочны. Некоторые можно взломать. Найди слабые.»

### Что значит «взломать»

Конкретная операция, которую выполняет игрок:

1. Берёт ключ **g извне** — любой ключ, которого нет на брелке
2. Берёт ключ **h с брелка** — один из ключей подгруппы
3. Выполняет **«обходной манёвр»**: применяет g, потом h, потом обратный g (то есть g⁻¹)

**Три шага. На карте это выглядит как петля**: ушёл из крыла → сделал что-то → вернулся.

**Вопрос**: результат этих трёх шагов (ghg⁻¹) — это ключ, который уже есть на брелке, или нет?

- **Если результат НЕ на брелке** → взлом удался! Игрок «протащил» ключ через чёрный ход и получил нечто, чего в брелке не было. **Крыло дырявое** — это НЕ нормальная подгруппа.
- **Если результат ВСЕГДА на брелке** (что бы игрок ни выбирал в качестве g и h) → взлом невозможен. **Крыло герметично** — это **нормальная подгруппа**.

### Как это выглядит на экране

**Интерфейс разделён на три зоны:**

1. **Слева — брелок**: набор ключей-квадратиков определённых цветов. Это текущая подгруппа H, которую проверяем.

2. **Справа — остальные ключи**: «отмычки» для взлома. Ключи, которые есть в полной группе G, но не в подгруппе H.

3. **Внизу — зона «обходного манёвра»**: три слота в ряд:
   - **Слот 1**: сюда перетаскивается ключ-отмычка g (извне брелка)
   - **Слот 2**: сюда перетаскивается ключ h (с брелка)
   - **Слот 3**: заполняется автоматически — g⁻¹ (игра уже знает обратные ключи из слоя 2)

**Процесс взлома:**
1. Игрок перетаскивает ключ из правой зоны в слот 1
2. Игрок перетаскивает ключ из левой зоны (брелок) в слот 2
3. Слот 3 автоматически заполняется обратным к слоту 1
4. Игрок нажимает кнопку **«Выполнить манёвр»**
5. Игра показывает **анимацию на карте**: три последовательных перехода между комнатами, три дуги разного цвета
6. Игра показывает **результат** — ключ, который получился

**Визуальная обратная связь:**
- Если результат совпадает с ключом из брелка → этот ключ **вспыхивает внутри брелка** (зелёное свечение)
- Если результат НЕ совпадает → этот ключ **вспыхивает снаружи брелка** (красное свечение + звук треска)

### Два режима игры

#### Режим 1: Ненормальная подгруппа (взлом возможен)

Игрок пробует разные пары (g, h). Большинство комбинаций не ломают крыло — результат возвращается в брелок. Но в какой-то момент — **бам!** — результат вылетел за пределы брелка.

**Экран**:
> «Брелок взломан! Нашёл слабое место.»
> *Показывает найденную пару (g, h) и результат ghg⁻¹ ∉ H*

**Ощущение игрока**: я хакер, нашёл дыру в защите!

**Награда**:
- Локация помечается как пройденная (красный цвет)
- Открывается запись в дневнике: «Этот брелок имеет уязвимость. Некоторые ключи извне могут "просочиться" внутрь.»

#### Режим 2: Нормальная подгруппа (взлом невозможен)

Игрок пробует и пробует. Каждая комбинация возвращает ключ из брелка. Счётчик попыток растёт: 5, 10, 15...

Игрок начинает подозревать, что этот брелок **невозможно взломать**.

**Появляется кнопка** (активна после минимум 10 попыток):
> **«Этот брелок невозможно взломать»**

Если игрок нажимает её:
- Игра проверяет, действительно ли это нормальная подгруппа (математическая проверка на бэкенде)
- Если игрок прав → **особая награда**:

**Экран**:
> «Брелок неуязвим. Это что-то особенное.»
> *Локация помечается золотым сиянием*
> «Такие брелки называются НОРМАЛЬНЫМИ ПОДГРУППАМИ. Они особенные — через них можно строить факторгруппы.»

**Награда**:
- **«Печать невозможности»** — специальная награда за доказательство невозможности
- Разблокируется переход к слою 5 (факторгруппы) для этой локации

Если игрок ошибся (подгруппа на самом деле НЕ нормальная):
- Игра мягко показывает контрпример: «Попробуй эту пару (g, h) — она ломает брелок»
- Штрафа нет, игрок может продолжить поиск

### Защита от читерства

Чтобы кнопка «невозможно взломать» не превратилась в способ пропускать сложные уровни:

1. **Минимальное количество попыток**: нужно попробовать хотя бы 10 разных комбинаций (или 50% всех возможных пар, если группа маленькая)

2. **Системная проверка**: игрок должен попробовать хотя бы одну комбинацию с каждым ключом из брелка (чтобы показать, что проверил все элементы подгруппы)

3. **Предъявление свидетельства** (опционально, для продвинутых игроков): показать список всех проверенных пар в мини-окне перед утверждением невозможности

### Математическая суть

Игрок проверяет условие нормальности подгруппы:

**H ⊲ G ⟺ ∀g ∈ G, ∀h ∈ H: ghg⁻¹ ∈ H**

Это сопряжение элемента подгруппы произвольным элементом группы. Если результат всегда остаётся в подгруппе — подгруппа нормальна.

### Интуиция, которую получает игрок

- **Нормальная подгруппа** = герметичное крыло, которое нельзя «просочить» снаружи
- **Ненормальная подгруппа** = дырявое крыло, через которое можно протащить внешние ключи
- **Сопряжение** = обходной манёвр: выйти из крыла, сделать операцию, вернуться

Это чисто тактильное понимание, без формул. Но оно **абсолютно точное** математически.

---

## 4. Переработка Акта 3: «Палитра» через действие, а не абстракцию

### Проблема
Исходная «палитра с правилами смешивания» — это замаскированная таблица умножения поля. Для игрока, который до этого двигал кристаллы, это слишком абстрактный скачок. Разрыв сравним с тем, как если бы в Portal на 30-м уровне внезапно появились дифференциальные уравнения.

### Решение: вместо палитры — «Ткацкий станок»

Новая метафора для расширений полей — **ткачество**. Вот как это работает:

У игрока есть набор **нитей** — каждая нить имеет цвет. Нити можно **переплетать** (это операция поля). Переплетение двух нитей даёт новую нить предсказуемого цвета — правила переплетения фиксированы и видимы.

Некоторые залы содержат кристаллы, окрашенные в цвет, которого нет среди нитей игрока. Чтобы войти, нужно **добавить нить нового цвета** и определить, как она переплетается со всеми существующими.

Почему это лучше абстрактной палитры:

- **Физичность.** Игрок буквально протягивает нити через станок и видит, какой цвет получается. Это тактильная операция, а не заполнение таблицы.
- **Ограничения видны.** Если новая нить несовместима с правилами (нарушает ассоциативность или порождает противоречие), ткань «расползается» — визуально и звуково. Игрок чувствует, что не любое расширение допустимо.
- **Автоморфизмы расширения = перекраска нитей.** Если можно перекрасить новую нить в другой цвет, и вся ткань останется непротиворечивой — это автоморфизм. Игрок пробует перекраски так же, как раньше пробовал перестановки кристаллов. Одинаковый жест — перетаскивание — в разном контексте.

### Сшивка с Актами 1–2
Критический момент: когда игрок добавляет нить и обнаруживает допустимые перекраски, ткацкий станок **трансформируется в зал с кристаллами**, где перекраски — это ключи. Игрок видит это превращение анимированно. Так связь между расширениями и группами не объясняется — она *происходит на экране*.

---

## 4. Механика «Двойного зрения» вместо двух экранов

### Проблема
Два одновременных экрана (палитра и группа) — информационная перегрузка. Игрок не знает, куда смотреть.

### Решение
Один экран с переключением «режимов зрения» — горячая клавиша или жест. В режиме A игрок видит ткацкий станок (расширение). В режиме B — зал с кристаллами (группа). Переключение мгновенное, с плавной морф-анимацией, где нити перестраиваются в кристаллы и обратно.

Суть: каждому элементу ткацкого станка однозначно соответствует элемент зала. Промежуточная нить ↔ подгруппа ключей. Игрок может решить головоломку в любом режиме, но некоторые вещи проще увидеть в одном, а другие — в другом. Игра мотивирует переключаться.

Конкретный пример: нужно найти промежуточное расширение. В режиме A (ткань) — это «какие нити можно убрать, чтобы ткань не развалилась?». В режиме B (зал) — это «какие ключи образуют нормальную подгруппу?». Два способа увидеть одно и то же. Игрок начинает переключаться рефлекторно — и в этот момент соответствие Галуа прошивается в моторную память.

---

## 7. «Невозможные локации» — обучение через провал

### Проблема
В оригинальном проекте игрок всегда побеждает. Но центральная теорема теории Галуа — теорема о *невозможности*. Если игрок не переживёт невозможность как опыт, он не поймёт самого главного.

### Решение: локации-ловушки

Начиная со **слоя 3** (группы), среди обычных локаций попадаются **невозможные** — задания, которые *нельзя* выполнить.

**Примеры по слоям:**

**Слой 3 (группы):** «Найди набор из 3 ключей, которые образуют группу» — но в локации ровно 2 ключа, и никакая тройка не замкнута.

**Слой 4 (нормальные группы):** «Найди нормальную подгруппу» в локации с **простой группой** (например, Z₅ или A₅). Нетривиальных нормальных подгрупп не существует.

**Слой 5 (факторгруппы):** «Разложи эту группу на два слоя» для A₅ (нельзя, она простая).

### Механика

Игрок не знает заранее, что локация невозможная. Он пробует, пробует, и в какой-то момент может нажать кнопку:
> **«Я утверждаю, что это невозможно»**

**Если прав:**
- Локация засчитывается как пройденная
- Особая награда: **«Печать Невозможности»** (золотой значок)
- Запись в дневнике с объяснением, почему это невозможно

**Если неправ:**
- Игра мягко показывает контрпример (пример того, как задание можно выполнить)
- Штрафа нет, игрок может продолжить поиск

### Защита от злоупотреблений

Чтобы кнопка «невозможно» не превратилась в способ пропускать сложные уровни:

1. **Минимальное количество попыток** (например, 10+ для слоя 4)
2. **Предъявление свидетельства** — показать, что игрок проверил достаточно вариантов
3. **Задержка активации** — кнопка появляется только после 5 минут работы над локацией

### Педагогическая ценность

Это критически важная механика. Она учит тому, чему математика учит в первую очередь:

> **«Невозможно» — это тоже ответ, и он может быть строго обоснован.**

---

## 8. Мультиплеер: «Локация на двоих»

### Зачем
Теория Галуа — это про соответствие между двумя точками зрения. Два игрока — естественная метафора.

### Механика
Кооперативный режим на двоих (локальный или онлайн). Один игрок видит ткацкий станок (расширение). Второй — зал с кристаллами (группу). Они должны *общаться словами*, чтобы вместе решить головоломку, потому что каждый видит только половину картины.

Пример: игроку A нужно найти промежуточное расширение, но он не знает, какие подгруппы нормальны. Игрок B видит подгруппы, но не знает, как они связаны с нитями. Они должны выработать общий язык — «у меня есть подгруппа из трёх ключей, один из которых — отражение» → «попробую убрать синюю нить, потому что у неё три варианта перекраски».

Это гениально с педагогической точки зрения: необходимость *объяснить другому* то, что ты видишь, — самый сильный из известных механизмов обучения.

---

## 9. Sandbox-режим: «Мастерская»

### Зачем
Самое глубокое понимание приходит не от решения чужих задач, а от создания своих.

### Механика
После прохождения каждого слоя открывается мастерская, где игрок может:

- **Построить свой зал**: расставить кристаллы, провести связи, и увидеть, какую группу симметрий он случайно создал. Игра автоматически считает группу и показывает её свойства.
- **Построить свой ткацкий станок**: задать правила переплетения и увидеть, какая структура возникнет.
- **Задать задачу другу**: сконструировать зал и отправить другому игроку как челлендж.

Для продвинутых игроков — режим «Каталог», где игра предлагает: «Построй зал с группой, изоморфной S₃», и игрок конструирует граф, проверяя гипотезы.

---

## 5. Слой 5: Факторгруппы — склеивание пространства

### Задача слоя
Игрок знает, что такое нормальные подгруппы (слой 4). Теперь он учится **использовать** их для построения новых, меньших групп — факторгрупп.

### Механика
Для каждой локации с нормальной подгруппой H игрок:

1. Видит зал, разбитый на **«секторы»** — классы смежности gH
2. Может **склеить** все комнаты одного сектора в одну «большую комнату»
3. Получает новый, меньший зал, где элементы — это склеенные секторы
4. Проверяет, что новый зал тоже имеет групповую структуру — это **факторгруппа G/H**

**Визуализация:**
- Исходный зал показан с цветовой кодировкой: комнаты, связанные действиями из H, окрашены одним цветом
- Игрок нажимает «склеить» — анимация сворачивания: комнаты сливаются в одну
- Остаётся меньший зал, где операции — это «прыжки между секторами»

**Критерий успеха:**
Новая структура удовлетворяет аксиомам группы (проверяется автоматически).

### Интуиция
- **Факторгруппа** = упрощённая версия большой группы, где мелкие детали «замазаны»
- **Класс смежности** = набор комнат, которые «выглядят одинаково» с точки зрения подгруппы H
- **Операция в факторгруппе** = движение между кластерами, игнорируя внутреннюю структуру

---

## 6. Переработка финала (Слой 4-5, финальная локация A₅)

### Проблема
В оригинальном проекте босс A₅ — просто очень сложный зал. Но драматургически не хватает *осмысления*.

### Решение: три фазы финала

**Фаза 1 — Ложная надежда (Слой 4).**

Игрок достигает финальной локации «Центральный Храм» на слое 4 (красный цвет — нормальные группы).

Он видит группу S₅ (120 симметрий) и начинает взламывать брелки. Он находит один брелок, который невозможно взломать — **A₅** (60 симметрий). Это нормальная подгруппа! Игрок получает награду и переходит к слою 5 для этой локации.

**Фаза 2 — Стена (Слой 5).**

На слое 5 (фиолетовый цвет — факторгруппы) игрок строит факторгруппу S₅/A₅ ≅ Z₂. Это работает!

Теперь игра предлагает: «Попробуй разложить A₅ дальше. Найди нормальную подгруппу внутри A₅».

Игрок возвращается к слою 4, но теперь работает с группой A₅. Он начинает взламывать брелки внутри A₅:
- Пробует подгруппу порядка 2 (Z₂) — взломана!
- Пробует подгруппу порядка 3 (Z₃) — взломана!
- Пробует подгруппу порядка 5 (Z₅) — взломана!
- Пробует четвёрку Клейна (V₄ ≅ Z₂ × Z₂) — взломана!
- Пробует диэдральную группу D₅ — взломана!
- Пробует знакопеременную A₄ — взломана!

Никакая подгруппа не проходит тест. Все ненормальны (кроме тривиальных {e} и самой A₅).

Кнопка **«Этот зал невозможно разложить дальше»** активна, но нажать её — значит признать, что путь закончен.

**Фаза 3 — Принятие.**

Когда игрок нажимает «невозможно» (после проверки достаточного количества подгрупп), зал не открывается обычной анимацией.

Вместо этого:
1. **Тишина.** Экран затемняется.
2. **Обратная перспектива.** Камера медленно отъезжает, показывая всю карту сверху.
3. **Пять цветовых слоёв** мерцают по очереди — синий, зелёный, золотой, красный, фиолетовый — показывая весь путь игрока.
4. Множество локаций подсвечиваются — те, которые удалось разложить на факторгруппы. Центральный Храм остаётся тёмным.
5. **Голос исследователя** из дневника:

> «Я потратил три года, пытаясь вскрыть этот зал послойно. Сегодня я понял, что провёл три года не впустую. Я доказал, что это невозможно. И это — более глубокое знание, чем если бы он просто открылся.
>
> A₅ — это простая группа. Она неразложима. Из-за её простоты не существует общей формулы для решения уравнений пятой степени. Эварист Галуа открыл это в 1832 году. Ему было двадцать лет.»

6. **Центральный Храм** подсвечивается особым золотым светом — «Печать Невозможности».
7. Зал засчитывается как пройденный.
8. Титры.

---

## 10. Система подсказок: «Эхо»

### Проблема
Головоломки без подсказок отсеивают большинство игроков. Головоломки с подсказками убивают удовольствие от открытия.

### Решение: трёхуровневая система
Если игрок застрял (не делал прогресса 5+ минут), в углу экрана начинает мерцать значок «Эхо» — фрагмент записей предыдущего исследователя.

**Уровень 1 — Направление.** Расплывчатый намёк. Пример: «Исследователь пометил на полях: *Попробуй начать с крайнего узла — он единственный, который связан со всеми.*»

**Уровень 2 — Структура.** Более конкретная подсказка. Пример: «В записях нарисована стрелка от кристалла A к кристаллу C с пометкой: *эти двое всегда ходят парой.*»

**Уровень 3 — Решение.** Пошаговое объяснение одного возможного пути. Доступно только после двух предыдущих уровней. Снимает «Печать совершенства» с зала, но не «Печать прохождения».

Каждый уровень подсказки требует отдельного нажатия с задержкой в 2 минуты. Это не даёт импульсивно проскроллить до ответа, но и не мучает тех, кому реально нужна помощь.

---

## 11. «Глоссарий живых понятий»

### Зачем
Игрок проходит игру и получает интуицию — но не знает слов. Если через полгода он откроет учебник алгебры, он не узнает знакомые концепции. Нужен мост.

### Решение
В меню доступен **Глоссарий**, который заполняется по мере прохождения. Каждая запись состоит из трёх слоёв:

**Слой 1 — Игровой термин.** «Кольцо ключей зала» — это набор всех допустимых перестановок.

**Слой 2 — Наблюдение.** «Кольцо ключей всегда содержит «пустой» ключ (ничего не двигать) и для каждого ключа — обратный ключ, который отменяет его действие. Комбинация двух ключей всегда тоже ключ.»

**Слой 3 — Математическое имя (скрыт по умолчанию).** «В математике это называется *группой автоморфизмов графа*. Более общее понятие — *группа*. Замкнутость, наличие единицы, наличие обратного — это аксиомы группы.»

Третий слой открывается по нажатию, и игрок видит: «О, так то, что я делал — это группа!» Этот момент узнавания — одно из самых мощных обучающих переживаний.

В конце игры глоссарий содержит около 25 записей, покрывающих: группу, подгруппу, нормальную подгруппу, факторгруппу, простую группу, разрешимую группу, порядок элемента, генераторы, изоморфизм, автоморфизм, расширение поля, промежуточное расширение, группу Галуа, соответствие Галуа, разрешимость уравнений.

---

## 12. Звуковой дизайн как обучающий инструмент

### Идея
Каждая группа имеет свой **звуковой портрет**. Не музыку-фон — а звук, порождённый структурой группы.

Как это работает: каждому элементу группы присвоен тон. Композиция двух элементов — аккорд из трёх нот (два исходных + результат). Коммутативные группы звучат гармонично (порядок не важен — аккорды симметричны). Некоммутативные — диссонансно. Циклические группы звучат как восходящие гаммы. S₃ — как джаз. A₅ — как нечто сложное, атональное, несводимое к простым интервалам.

Игрок, пройдя десяток залов, начинает *на слух* различать типы групп. Это не обязательно для прохождения — но те, кто обратит внимание, получат ещё один канал интуиции.

Особый момент: когда игрок пытается разложить A₅ и терпит неудачу, звуковой портрет этой группы не распадается на простые мелодии. Он остаётся цельным, неразложимым звуком. Это эстетическое переживание невозможности.

---

## 13. Послеигровой «мост» — от игры к математике

### Зачем
Если игра заканчивается титрами — связь с реальной математикой остаётся хрупкой. Нужен мягкий выход в реальный мир.

### Решение
После титров открывается **«Библиотека храма»** — раздел с тремя уровнями глубины:

**«Открытки»** — 10 коротких текстов (по абзацу), связывающих игровой опыт с историей математики. Пример: «Зал A₅, который ты не смог разложить — это та самая причина, по которой Эварист Галуа в 1832 году доказал, что не существует общей формулы для решения уравнений пятой степени. Ему было двадцать лет.»

**«Карта знаний»** — визуальная схема, показывающая, какие разделы математики соответствуют каким слоям игры. Со ссылками на конкретные главы конкретных учебников (например: «Слой 3 → Hungerford, *Abstract Algebra*, Chapter 2.5» или «Visual Group Theory, Nathan Carter — вся книга»).

**«Нерешённые залы»** — краткие описания открытых проблем теории групп и теории Галуа, сформулированных в терминах игры. Например: «Существуют ли залы, в которых количество ключей не встречается ни в одном из известных нам шаблонов?» (Обратная задача Галуа.) Это не для того, чтобы игрок их решил — а чтобы он почувствовал, что храм продолжается за пределы игры.

---

## Сводка изменений

| # | Изменение | Что решает | Приоритет |
|---|-----------|-----------|-----------|
| 0 | **Архитектура слоёв: единая карта, 5 цветов** | Линейность, повторяемость обучения | **Критический** |
| 1 | Единая карта с древовидной структурой | Ощущение исследования, свобода | Высокий |
| 2 | Активные заметки | Пассивность обучения | Высокий |
| 3 | **Слой 3: Группы** — композиция ключей | Понимание групповой структуры | Критический |
| 3.5 | **Слой 4: Механика «Взлом брелков»** | Интуитивное понимание нормальности | **Критический** |
| 4 | Ткацкий станок вместо палитры (Акт 3) | Разрыв абстракции в расширениях полей | Критический |
| 5 | **Слой 5: Факторгруппы** — склеивание | Понимание факторизации | Критический |
| 6 | Трёхфазный финал с A₅ | Драматургия и осмысление невозможности | Высокий |
| 7 | Невозможные локации | Обучение доказательствам невозможности | Высокий |
| 8 | Кооперативный мультиплеер | Глубина понимания через объяснение | Средний |
| 9 | Sandbox-мастерская | Обучение через конструирование | Средний |
| 10 | Система подсказок «Эхо» | Удержание аудитории | Высокий |
| 11 | Живой глоссарий | Мост к формальной математике | Высокий |
| 12 | Звуковой дизайн групп | Дополнительный канал интуиции | Средний |
| 13 | Библиотека храма | Послеигровой мост | Средний |

---

## Финальное замечание

Самое важное изменение — не конкретная механика, а **принцип**: игрок должен не только *решать*, но и *формулировать*, *предсказывать*, *конструировать* и *признавать невозможность*. Это четыре режима математического мышления, и игра, которая задействует все четыре, учит не теории Галуа как набору фактов — а тому, как думает математик.
